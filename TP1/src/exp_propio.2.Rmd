---
title: "Experimento Propio"
author: 
    - "Patricio Guledjuan"
    - "Azul Noguera"
    - "Rocio Gonzalez"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r, echo=FALSE}
#source("exp_propio.R")
```

```{r, echo=FALSE}
library(rpart)
```

## Introducción

El objetivo de nuestro experimento consistió en explorar y comprender el impacto de las variables en el rendimiento del modelo. A través del análisis de las variables más influyentes, buscamos obtener una visión más profunda de cómo se toman decisiones en el contexto de cada conjunto de datos. Además, evaluamos si la selección de características relevantes podría potencialmente mejorar el desempeño del modelo.

Nuestro enfoque implicó identificar las variables más significativas en función del comportamiento del modelo original y, posteriormente, elegir las variables más influyentes para construir un nuevo modelo. Esta estrategia nos permitió comparar el rendimiento del nuevo modelo con el del original y analizar cualquier diferencia resultante.

En una primera etapa, evaluamos la importancia de los atributos en el modelo original utilizando rpart. En este contexto, una alta puntuación de importancia sugiere que la variable ejerce una mayor influencia en las decisiones tomadas por el árbol, y por ende, en las predicciones resultantes.

```{r, echo=FALSE}

#Buscamos las variables mas importantes de el dataset Churn
datos_churn <- read.csv("./data/customer_churn.csv")
data_df_churn <- datos_churn

tree_churn <- rpart(churn ~ ., data=data_df_churn, control=rpart.control(minsplit=2, minbucket=1, maxdepth=10, cp=0, xval=0))

variable_importance_churn <- tree_churn$variable.importance

mean_variable_importance_churn <- mean(variable_importance_churn)

data.frame(Churn_Importance = variable_importance_churn)
```

```{r, echo=FALSE}

#Buscamos las variables mas importantes de el dataset Heart
datos_heart <- read.csv("./data/heart.csv")
data_df_heart <- datos_heart

tree_heart <- rpart(HeartDisease ~ ., data=data_df_heart, control=rpart.control(minsplit=2, minbucket=1, maxdepth=10, cp=0, xval=0))

variable_importance_heart <- tree_heart$variable.importance

mean_variable_importance_heart <- mean(variable_importance_heart)

data.frame(Heart_Importance = variable_importance_heart)
```

```{r, echo=FALSE}

#Buscamos las variables mas importantes de el dataset Wine.
datos_wine <- read.csv("./data/winequality_modificados.csv")
data_df_wine <- datos_wine

tree_wine <- rpart(quality ~ ., data=data_df_wine, control=rpart.control(minsplit=2, minbucket=1, maxdepth=10, cp=0, xval=0))

variable_importance_wine <- tree_wine$variable.importance

mean_variable_importance_wine <- mean(variable_importance_wine)

data.frame(Wine_Importance = variable_importance_wine)
```
A partir de estos valores de importancia, establecimos una estrategia para determinar qué variables serían incluidas en el nuevo conjunto de datos. Para ello, calculamos el valor promedio de importancia de todas las variables presentes en el conjunto de datos original. Posteriormente, seleccionamos aquellas variables cuya importancia superara este promedio. Como resultado, cada uno de los conjuntos de datos originales se redujo a un conjunto de seis variables predictoras de mayor relevancia.

```{r, echo=FALSE}
#Tabla con importancia promedio por dataset 
data.frame(Dataset = c("ChurnRate", "HeartDisease", "WineQuality"), 
           Importancia_Promedio = c(mean_variable_importance_churn, mean_variable_importance_heart, mean_variable_importance_wine)
           )
```